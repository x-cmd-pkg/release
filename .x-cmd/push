# shellcheck shell=dash

cd "$(x wsroot)" || return 1

case "$1" in
    pre_release)
        git add "$(x wsroot)"
        git commit -m "update pkg bundle package by $GITHUB_RUN_NUMBER"
        git push -f git@github.com:x-cmd-pkg/release main dist/${___X_CMD_PKG_RELEASE_VERSION}.tar.gz
        git push -f git@github.com:x-cmd-pkg/release main dist/${___X_CMD_PKG_RELEASE_VERSION}_hash.txt
        ;;
    fabu)
        git clone git@github.com:x-cmd-pkg/release
        cd release || return
        # git push -f git@github.com:x-cmd/pkg main:dist/${___X_CMD_PKG_RELEASE_VERSION}.tar.gz
        # git push -f git@github.com:x-cmd/pkg main:dist/${___X_CMD_PKG_RELEASE_VERSION}_hash.txt

        # git push -f git@git@gitee.com:x-cmd/pkg main:dist/${___X_CMD_PKG_RELEASE_VERSION}.tar.gz
        # git push -f git@git@gitee.com:x-cmd/pkg main:dist/${___X_CMD_PKG_RELEASE_VERSION}_hash.txt

        git push -f git@gitcode.net:x-cmd/pkg main:dist/${___X_CMD_PKG_RELEASE_VERSION}.tar.gz
        git push -f git@gitcode.net:x-cmd/pkg main:dist/${___X_CMD_PKG_RELEASE_VERSION}_hash.txt
            ;;

    test_doc)
        git add "$(x wsroot)/doc"
        git commit -m "update pkg test doc by $GITHUB_RUN_NUMBER"
        git push git@github.com:x-cmd/pkg "$(git branch --show-current)"
        ;;
    *)
        x:error "unknown push type: $1"
        return 1
esac
