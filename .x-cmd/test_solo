# shellcheck shell=dash

test_solo_main()(
    if [ "$___X_CMD_PKG_CANDADITE" = "python" ] && [ "$(x os name)" = "win" ];then
        local path
        path="$(cygpath -w "${___X_CMD_ROOT_DATA}")"
        echo "path: " "$path" >&2
        echo "DOWNLOAD_PATH: " "$___X_CMD_PKG_DOWNLOAD_PATH" >&2
        echo "POPULATE_PATH: " "$___X_CMD_PKG_POPULATE_PATH" >&2
        ls "/c/WINDOWS/System32/WindowsPowerShell/v1.0/"dowsPowerShell/v1.0/PowerShell.exe "Start-Process -Wait -FilePath \"$path\pkg\download\python\py310_23.1.0-1_win_x64.exe\"  -ArgumentList \"/S /D=$path\pkg\populate\python\py310_23.1.0-1\""
    fi

    x cd .tmp/x-cmd-pkg && \
    xws install "$1" && \
    x pkg _smoke "$___X_CMD_PKG_CANDADITE" "${___X_CMD_PKG_CANDADITE_VERSION}" || return
)

x cd "$(x wsroot)"
xws prepare || return 1
test_solo_main "${___X_CMD_PKG_VERSION:-v0.0.2}" || return
